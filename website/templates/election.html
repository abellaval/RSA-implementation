{% extends 'base.html' %}

{% block title %} Vote {% endblock %}

{% block body %}
    <script src="{{ url_for("static", filename="js/blinding.js") }}" type="text/javascript"></script>
    <h3 style="text-align:center;">{{ election.name }}</h3>
    <h6 style="text-align:left; margin:1em 10vw; overflow-wrap: break-word;">
        <b>Votre <em><abbr title="Votre identifiant unique pour cette élection.">Vote Token</abbr></em>:</b>
        <span style="text-align: justify">{{ vote_token }}</span>
    </h6>
    {% set signing_e, signing_N = admin_signing_pk.split('$') %}
    <h6 style="text-align:left; margin:1em 10vw; overflow-wrap: break-word;">
        <b>La clef de <em><abbr title="Utilisé pour la signature a l'aveugle.">signature</abbr></em>:</b>
        <br/>
        <span style="text-align: justify"><b>e</b> = {{ "%0x" | format(signing_e | int) }}</span>
        <br/>
        <span style="text-align: justify"><b>N</b> = {{ "%0x" | format(signing_N | int) }}</span>
    </h6>
    <h3 style="text-align:center;">Liste de candidats</h3>

    {% for candidate, candidate_number in election.candidates %}

        <div class="card border-primary mb-3">
            <div class="card-header">
                <h2>"{{ candidate.name }}" </h2>
            </div>
            <div class="card-body">
                [Description du candidat {{ candidate.name }}]
            </div>
            <div class="card-footer">
                <form name="candidate:{{ candidate_number }}" id="form:{{ candidate_number }}"
                      action="/api/make_choice/" onsubmit="onSubmitToAdmin(this);" method="post">
                    <input type="hidden" id="election_id" name="election_id" value={{ election.id }}>
                    <input type="hidden" id="vote_token" name="vote_token" value={{ vote_token }}>
                    <input type="hidden" id="blinded_choice" name="blinded_choice" value={{ candidate_number }}>
                    <input type="hidden" id="admin_signing_pk" name="admin_signing_pk" value={{ admin_signing_pk }}>
                    <button type="submit" class="btn btn-outline-success">
                        Voter
                    </button>
                </form>
            </div>
        </div>


    {% endfor %}

{% endblock %}
